Refatore o arquivo utilizando como referência, com as seguintes melhorias:

1. Reorganize a estrutura do código para melhor legibilidade e manutenção
2. Divida em componentes menores e mais especializados
3. Realoque trechos de código para arquivos/pastas mais apropriados quando necessário
4. Aplique princípios de modularização para otimizar a arquitetura
5. Mantenha a funcionalidade existente enquanto melhora a organização geral

O objetivo principal é criar uma estrutura mais limpa e modular que facilite futuras manutenções e melhorias no código.
